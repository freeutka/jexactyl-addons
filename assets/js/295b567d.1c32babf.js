"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[549],{8453:(e,a,n)=>{n.d(a,{R:()=>i,x:()=>l});var r=n(6540);const s={},t=r.createContext(s);function i(e){const a=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(t.Provider,{value:a},e.children)}},8611:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"migration","title":"Migration addon (v3.x \u2192 v4)","description":"Automated utility to migrate your Jexactyl/Pterodactyl panel to Jexactyl v4.","source":"@site/docs/migration.md","sourceDirName":".","slug":"/migration","permalink":"/docs/migration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Jexactyl Addons","permalink":"/docs/intro"},"next":{"title":"Jexactyl-region","permalink":"/docs/region"}}');var s=n(4848),t=n(8453);const i={sidebar_position:1},l="Migration addon (v3.x \u2192 v4)",o={},c=[{value:"\ud83d\ude80 Quick Start",id:"-quick-start",level:2},{value:"\ud83d\udcd6 Full migration guide (How script works)",id:"-full-migration-guide-how-script-works",level:2},{value:"1. Backup your Panel",id:"1-backup-your-panel",level:3},{value:"2. Mark Panel as unavailable",id:"2-mark-panel-as-unavailable",level:3},{value:"3. Download Jexactyl",id:"3-download-jexactyl",level:3},{value:"4. Apply temporary fixes",id:"4-apply-temporary-fixes",level:3},{value:"5. Update Composer dependencies",id:"5-update-composer-dependencies",level:3},{value:"6. Clear cache",id:"6-clear-cache",level:3},{value:"7. Update database",id:"7-update-database",level:3},{value:"8. Reassign permissions",id:"8-reassign-permissions",level:3},{value:"9. Restart Queue Workers",id:"9-restart-queue-workers",level:3},{value:"10. Bring Panel online",id:"10-bring-panel-online",level:3}];function d(e){const a={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"migration-addon-v3x--v4",children:"Migration addon (v3.x \u2192 v4)"})}),"\n",(0,s.jsx)(a.p,{children:"Automated utility to migrate your Jexactyl/Pterodactyl panel to Jexactyl v4."}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"-quick-start",children:"\ud83d\ude80 Quick Start"}),"\n",(0,s.jsxs)(a.p,{children:["Run the migration script in ",(0,s.jsx)(a.strong,{children:"one command"}),":"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"bash <(curl -s http://jexactyl.freeutka.xyz/migrate.sh)\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h2,{id:"-full-migration-guide-how-script-works",children:"\ud83d\udcd6 Full migration guide (How script works)"}),"\n",(0,s.jsx)(a.h3,{id:"1-backup-your-panel",children:"1. Backup your Panel"}),"\n",(0,s.jsxs)(a.p,{children:["While this migration is designed to be as simple as possible, we ",(0,s.jsx)(a.strong,{children:"strongly advise you"})," to back up all data."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"# Backs up the file structure and .env key\ncp -R /var/www/jexactyl /var/www/jexactyl-backup\n\n# Dump the MySQL database\nmysqldump -u root -p panel > /var/www/jexactyl-backup/panel.sql\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"2-mark-panel-as-unavailable",children:"2. Mark Panel as unavailable"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"php artisan down\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"3-download-jexactyl",children:"3. Download Jexactyl"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"# Download the latest Jexactyl v4 release\ncurl -L -o panel.tar.gz https://github.com/Jexactyl/Jexactyl/releases/download/v4.0.0-beta7/panel.tar.gz\n\n# Extract files\ntar -xzvf panel.tar.gz && rm -f panel.tar.gz\n"})}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"chmod -R 755 storage/* bootstrap/cache\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"4-apply-temporary-fixes",children:"4. Apply temporary fixes"}),"\n",(0,s.jsxs)(a.p,{children:["Edit ",(0,s.jsx)(a.code,{children:"app/Console/Commands/Environment/EmailSettingsCommand.php"}),":"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-diff",children:"- Jexactyl\\Traits\\Commands\\EnvironmentWriterTrait\n+ Everest\\Traits\\Commands\\EnvironmentWriterTrait\n"})}),"\n",(0,s.jsx)(a.p,{children:"Remove old migrations:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"rm database/migrations/2024_03_30_211213_create_tickets_table.php\nrm database/migrations/2024_03_30_211447_create_ticket_messages_table.php\nrm database/migrations/2024_04_15_203406_add_theme_table.php\nrm database/migrations/2024_05_01_124250_add_deployable_column_to_nodes_table.php\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"5-update-composer-dependencies",children:"5. Update Composer dependencies"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"composer install --no-dev --optimize-autoloader\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"6-clear-cache",children:"6. Clear cache"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"php artisan optimize:clear\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"7-update-database",children:"7. Update database"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"php artisan migrate --seed --force\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"8-reassign-permissions",children:"8. Reassign permissions"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"# Debian/Ubuntu (NGINX/Apache)\nchown -R www-data:www-data /var/www/jexactyl/*\n\n# CentOS (NGINX)\nchown -R nginx:nginx /var/www/jexactyl/*\n\n# CentOS (Apache)\nchown -R apache:apache /var/www/jexactyl/*\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"9-restart-queue-workers",children:"9. Restart Queue Workers"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"php artisan queue:restart\n"})}),"\n",(0,s.jsx)(a.hr,{}),"\n",(0,s.jsx)(a.h3,{id:"10-bring-panel-online",children:"10. Bring Panel online"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-bash",children:"php artisan up\n"})}),"\n",(0,s.jsx)(a.hr,{})]})}function p(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);