"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[549],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>d});var r=s(6540);const a={},i=r.createContext(a);function l(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(i.Provider,{value:n},e.children)}},8611:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"migration","title":"Migration addon (v3.x \u2192 v4)","description":"Automated utility to migrate your Jexactyl/Pterodactyl panel to Jexactyl v4.","source":"@site/docs/migration.md","sourceDirName":".","slug":"/migration","permalink":"/docs/migration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Jexactyl Addons","permalink":"/docs/intro"},"next":{"title":"Code Editor For Jexactyl","permalink":"/docs/monaco"}}');var a=s(4848),i=s(8453);const l={sidebar_position:2},d="Migration addon (v3.x \u2192 v4)",t={},c=[{value:"\ud83d\ude80 Quick Start",id:"-quick-start",level:2},{value:"\u2699\ufe0f Advanced Usage with Arguments",id:"\ufe0f-advanced-usage-with-arguments",level:2},{value:"Basic Syntax",id:"basic-syntax",level:3},{value:"Available Arguments",id:"available-arguments",level:3},{value:"Usage Examples",id:"usage-examples",level:3},{value:"Interactive Mode",id:"interactive-mode",level:3},{value:"\ud83d\udcd6 Full migration guide (How script works)",id:"-full-migration-guide-how-script-works",level:2},{value:"1. Backup your Panel",id:"1-backup-your-panel",level:3},{value:"2. Mark Panel as unavailable",id:"2-mark-panel-as-unavailable",level:3},{value:"3. Download Jexactyl",id:"3-download-jexactyl",level:3},{value:"4. Apply temporary fixes",id:"4-apply-temporary-fixes",level:3},{value:"5. Update Composer dependencies",id:"5-update-composer-dependencies",level:3},{value:"6. Clear cache",id:"6-clear-cache",level:3},{value:"7. Update database",id:"7-update-database",level:3},{value:"8. Reassign permissions",id:"8-reassign-permissions",level:3},{value:"9. Restart Queue Workers",id:"9-restart-queue-workers",level:3},{value:"10. Bring Panel online",id:"10-bring-panel-online",level:3},{value:"\u2757 Troubleshooting",id:"-troubleshooting",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"migration-addon-v3x--v4",children:"Migration addon (v3.x \u2192 v4)"})}),"\n",(0,a.jsx)(n.p,{children:"Automated utility to migrate your Jexactyl/Pterodactyl panel to Jexactyl v4."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"#%EF%B8%8F-advanced-usage-with-arguments",children:"Arguments"})," is required!"]})}),"\n",(0,a.jsx)(n.h2,{id:"-quick-start",children:"\ud83d\ude80 Quick Start"}),"\n",(0,a.jsxs)(n.p,{children:["Run the migration script in ",(0,a.jsx)(n.strong,{children:"one command"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s https://sh.freeutka.xyz/migrate)\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\ufe0f-advanced-usage-with-arguments",children:"\u2699\ufe0f Advanced Usage with Arguments"}),"\n",(0,a.jsx)(n.p,{children:"The migration script supports command-line arguments for automated execution:"}),"\n",(0,a.jsx)(n.h3,{id:"basic-syntax",children:"Basic Syntax"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s https://sh.freeutka.xyz/migrate) [OPTIONS]\n"})}),"\n",(0,a.jsx)(n.h3,{id:"available-arguments",children:"Available Arguments"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Argument"}),(0,a.jsx)(n.th,{children:"Short"}),(0,a.jsx)(n.th,{children:"Description"}),(0,a.jsx)(n.th,{children:"Required"}),(0,a.jsx)(n.th,{children:"Default"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--dir DIR"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-d"})}),(0,a.jsx)(n.td,{children:"Working directory"}),(0,a.jsx)(n.td,{children:"No"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"/var/www/jexactyl"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--dbname NAME"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-n"})}),(0,a.jsx)(n.td,{children:"Database name"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Yes"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"panel"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--dbuser USER"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-u"})}),(0,a.jsx)(n.td,{children:"Database username"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Yes"})}),(0,a.jsx)(n.td,{children:"-"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--dbpass PASS"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-p"})}),(0,a.jsx)(n.td,{children:"Database password"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Yes"})}),(0,a.jsx)(n.td,{children:"-"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--dbhost HOST"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-h"})}),(0,a.jsx)(n.td,{children:"Database host"}),(0,a.jsx)(n.td,{children:"No"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"localhost"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--skip-backup"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-s"})}),(0,a.jsx)(n.td,{children:"Skip backup creation"}),(0,a.jsx)(n.td,{children:"No"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"false"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--yes"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"-y"})}),(0,a.jsx)(n.td,{children:"Auto-confirm all prompts"}),(0,a.jsx)(n.td,{children:"No"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"false"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"--help"})}),(0,a.jsx)(n.td,{}),(0,a.jsx)(n.td,{children:"Show help message"}),(0,a.jsx)(n.td,{children:"No"}),(0,a.jsx)(n.td,{children:"-"})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Fully automated migration (recommended for scripts):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s URL) --dbname panel --dbuser root --dbpass password123 --skip-backup --yes\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Custom directory and database:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s URL) -d /var/www/pterodactyl -n jexuser -u jexuser -p 123\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Minimal arguments (will prompt for missing info):"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s URL) -n panel -u root -p password123\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Show help:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash <(curl -s URL) --help\n"})}),"\n",(0,a.jsx)(n.h3,{id:"interactive-mode",children:"Interactive Mode"}),"\n",(0,a.jsx)(n.p,{children:"If you don't provide all required arguments, the script will prompt you for missing information:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Database username/password if not provided"}),"\n",(0,a.jsx)(n.li,{children:"Directory choice if not specified"}),"\n",(0,a.jsx)(n.li,{children:"Backup confirmation unless skipped"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-full-migration-guide-how-script-works",children:"\ud83d\udcd6 Full migration guide (How script works)"}),"\n",(0,a.jsx)(n.h3,{id:"1-backup-your-panel",children:"1. Backup your Panel"}),"\n",(0,a.jsxs)(n.p,{children:["While this migration is designed to be as simple as possible, we ",(0,a.jsx)(n.strong,{children:"strongly advise you"})," to back up all data."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Backs up the file structure and .env key\ncp -R /var/www/jexactyl /var/www/jexactyl-backup\n\n# Dump the MySQL database\nmysqldump -u root -p panel > /var/www/jexactyl-backup/panel.sql\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"2-mark-panel-as-unavailable",children:"2. Mark Panel as unavailable"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan down\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"3-download-jexactyl",children:"3. Download Jexactyl"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Download the latest Jexactyl v4 release\ncurl -L -o panel.tar.gz https://github.com/Jexactyl/Jexactyl/releases/download/v4.0.0-rc1/panel.tar.gz\n\n# Extract files\ntar -xzvf panel.tar.gz && rm -f panel.tar.gz\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"chmod -R 755 storage/* bootstrap/cache\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"4-apply-temporary-fixes",children:"4. Apply temporary fixes"}),"\n",(0,a.jsxs)(n.p,{children:["Edit ",(0,a.jsx)(n.code,{children:"app/Console/Commands/Environment/EmailSettingsCommand.php"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-diff",children:"- Jexactyl\\Traits\\Commands\\EnvironmentWriterTrait\n+ Everest\\Traits\\Commands\\EnvironmentWriterTrait\n"})}),"\n",(0,a.jsx)(n.p,{children:"Remove old migrations:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"rm database/migrations/2024_03_30_211213_create_tickets_table.php\nrm database/migrations/2024_03_30_211447_create_ticket_messages_table.php\nrm database/migrations/2024_04_15_203406_add_theme_table.php\nrm database/migrations/2024_05_01_124250_add_deployable_column_to_nodes_table.php\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"5-update-composer-dependencies",children:"5. Update Composer dependencies"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"composer install --no-dev --optimize-autoloader\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"6-clear-cache",children:"6. Clear cache"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan optimize:clear\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"7-update-database",children:"7. Update database"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan migrate --seed --force\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"8-reassign-permissions",children:"8. Reassign permissions"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Debian/Ubuntu (NGINX/Apache)\nchown -R www-data:www-data /var/www/jexactyl/*\n\n# CentOS (NGINX)\nchown -R nginx:nginx /var/www/jexactyl/*\n\n# CentOS (Apache)\nchown -R apache:apache /var/www/jexactyl/*\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"9-restart-queue-workers",children:"9. Restart Queue Workers"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan queue:restart\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"10-bring-panel-online",children:"10. Bring Panel online"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"php artisan up\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"-troubleshooting",children:"\u2757 Troubleshooting"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:'If stuck on "Welcome to Jexpanel":'}),"\nCheck that ",(0,a.jsx)(n.code,{children:"APP_ENVIRONMENT_ONLY=false"})," in your ",(0,a.jsx)(n.code,{children:".env"})," file"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Database connection errors:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Verify database credentials"}),"\n",(0,a.jsx)(n.li,{children:"Ensure MySQL user has proper permissions"}),"\n",(0,a.jsx)(n.li,{children:"Check if database exists"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Permission errors:"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Run permissions step manually"}),"\n",(0,a.jsx)(n.li,{children:"Verify web server user exists"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}}}]);